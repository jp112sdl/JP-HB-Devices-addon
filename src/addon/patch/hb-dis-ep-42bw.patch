--- ./patchsource/www/rega/esp/side.inc.orig	2018-12-01 18:41:47.000000000 +0100
+++ ./patchsource/www/rega/esp/side.inc	2018-11-30 18:59:29.000000000 +0100
@@ -15,6 +15,7 @@
   string hm_partyDialog = "HM-CC-RT-DN HM-TC-IT-WM-W-EU HM-CC-VG-1";
   string hm_statusDisplay = "HM-Dis-WM55";
   string hm_statusDisplayEPaper = "HM-Dis-EP-WM55";
+  string hb_statusDisplayEPaper = "HB-DIS-EP-42BW";
   string hm_rgbw_controller = "HM-LC-RGBW-WM";
   string hm_jalousieActor = "HM-LC-Ja1PBU";
   string heatingClimateControlTransceiver =  "HEATING_CLIMATECONTROL_TRANSCEIVER";
@@ -454,6 +455,7 @@
             integer partyDialogDevice = hm_partyDialog.Find(chLabel);
             integer statusDisplayDevice = hm_statusDisplay.Find(chLabel);
             integer statusDisplayEPaperDevice = hm_statusDisplayEPaper.Find(chLabel);
+            integer statusHbDisplayEPaperDevice = hb_statusDisplayEPaper.Find(chLabel);
             integer rgbw_controller = chLabel.Find(hm_rgbw_controller);
             integer i_vir_lg_rgb_dim = chLabel.Find(s_vir_lg_rgb_dim);
             integer i_vir_lg_rgbw_dim = chLabel.Find(s_vir_lg_rgbw_dim);
@@ -462,6 +464,7 @@
 
             if ((statusDisplayDevice != -1)
               || (statusDisplayEPaperDevice != -1)
+              || (statusHbDisplayEPaperDevice != -1)
               || (rgbw_controller != -1)
               || ((jalousieActor != - 1) && (oDP.HSSID().Find("LEVEL_COMBINED") != -1))
               || (((i_vir_lg_rgb_dim != - 1) && (oDP.HSSID().Find("RGB") != -1)) || ((i_vir_lg_rgbw_dim != - 1) && (oDP.HSSID().Find("RGBW") != -1)) || (( i_vir_lg_group != - 1) && (oDP.HSSID().Find("RGBW") != -1)))
@@ -482,6 +485,13 @@
                 Write( '<input id="prgStringOptionValue'#oSD.ID()#'" onfocus="SetStatusDisplay('#oSD.ID()#',\'DIS-EP\');" type="text" class="SelectBox" size="10" value="'#iV#'" onchange="iseSingleDestination.SetValue('#oSD.ID()#',this.value,\'STRING\');" /> ' );
               }
 
+              if (statusHbDisplayEPaperDevice != -1) {
+                if(iV == "1") {
+                  ! This is the default string for 'all values not used'
+                  iV = "0x02,0x0A,0x0A,0x0A,0x0A,0x0A,0x0A,0x0A,0x0A,0x0A,0x0A,0x03";
+                }
+                Write( '<input id="prgStringOptionValue'#oSD.ID()#'" onfocus="SetStatusDisplay('#oSD.ID()#',\'DIS-EP42BW\');" type="text" class="SelectBox" size="10" value="'#iV#'" onchange="iseSingleDestination.SetValue('#oSD.ID()#',this.value,\'STRING\');" /> ' );
+              }
               if (rgbw_controller != -1) {
 
                 if (iV == "0") {
@@ -532,6 +542,7 @@
               && (partyDialogDevice == -1)
               && (statusDisplayDevice == -1)
               && (statusDisplayEPaperDevice == -1)
+              && (statusHbDisplayEPaperDevice == -1)
               && (rgbw_controller == -1)
               && (jalousieActor == -1)
               && (i_vir_lg_rgb_dim == -1)
@@ -555,6 +566,9 @@
               if (statusDisplayEPaperDevice != -1) {
                 Write( '<span id="setStatusDisplayEPaper'#oSD.ID()#'" class="CLASS02401" onclick="SetStatusDisplay('#oSD.ID()#',\'DIS-EP\');"><img src="/ise/img/notepad.png" /></span>' );
               }
+              if (statusHbDisplayEPaperDevice != -1) {
+                Write( '<span id="setHbStatusDisplayEPaper'#oSD.ID()#'" class="CLASS02401" onclick="SetStatusDisplay('#oSD.ID()#',\'DIS-EP42BW\');"><img src="/ise/img/notepad.png" /></span>' );
+              }
               if (rgbw_controller != -1) {
                 Write( '<span id="setRGBWController'#oSD.ID()#'" class="CLASS02401" onclick="SetRGBWController('#oSD.ID()#',\''#oDP.HSSID()#'\');"><img src="/ise/img/notepad.png" /></span>' );
               }
--- ./patchsource/www/rega/esp/functions.fn.orig	2018-12-01 18:41:47.000000000 +0100
+++ ./patchsource/www/rega/esp/functions.fn	2018-12-01 10:11:26.000000000 +0100
@@ -331,6 +331,13 @@
     ! Hide channel 3 of this device
     bShowChannel = false;
   }
+  
+  ! HB Status Display EPaper 42BW
+  if(( (oDevHssType == "HB-DIS-EP-42BW") ) && (chNumber == 11)) {
+    ! Hide channel 11 of this device
+    bShowChannel = false;
+  }
+  
 }
 
 function ::showHideHmIPChannel() {
--- ./patchsource/www/webui/webui.js.orig	2018-12-01 18:41:47.000000000 +0100
+++ ./patchsource/www/webui/webui.js	2018-12-01 12:03:17.000000000 +0100
@@ -13146,7 +13146,7 @@
   // Check each line if the free text mode is active.
   // If yes switch on the appropriate text input field
   // and set the variable freeTextActive to true
-  for (var line = 0; line < 6; line++) {
+  for (var line = 0; line < 10; line++) {
     var jLine = jQuery("#textSelect_" + line),
     jCellFreeText = jQuery("#cellFreeText_"+line);
 
@@ -13162,7 +13162,7 @@
   // If at least one line has an active free text mode
   // we have to activate the placeholder for the other lines and the header (color and icon are moving up)
   if (freeTextActive) {
-    for (var line = 0; line < 6; line++) {
+    for (var line = 0; line < 10; line++) {
       var jLine = jQuery("#textSelect_" + line),
       jPlaceHolder = jQuery("#placeHolder_"+line);
 
@@ -13174,7 +13174,7 @@
     }
   } else {
     jHeadFreeText.hide().css("display", "none");
-    for (var line = 0; line < 6; line++) {
+    for (var line = 0; line < 10; line++) {
       jQuery("#placeHolder_"+line).hide().css("display", "none");
     }
   }
@@ -13867,6 +13867,217 @@
 
 YesNoDialog.RESULT_NO = 0;
 YesNoDialog.RESULT_YES = 1;
+
+HbStatusDisplayDialogEPaper = Class.create(StatusDisplayDialog, {
+
+  initEPaper: function () {
+    conInfo("HbStatusDisplayDialogEPaper - initEPaper");
+    this.displayType = "DIS-EP42BW";
+  },
+
+    // This creates the content of the dialog.
+  _addElements: function() {
+    var dialogContentElem = jQuery("#statusDisplayDialog"),
+    textOptions = this._getTextOptions(),
+    iconOptions = this._getIconOptions(),
+
+    freeTextValue = translateKey("statusDisplayOptionFreeText"),
+    arrDisabledElements = ["disabled", "","","","disabled","disabled"];
+
+    dialogContentElem.append(function(index,html){
+      //var content =  "<tr><th>&nbsp;</th><th>Text</th> <th id='headFreeText' class='hidden'></th><th name='optionHeader'>Color</th><th name='optionHeader'>Icon</th></tr>";
+      var content =  "<tr><th>&nbsp;</th><th>Text</th> <th id='headFreeText' class='hidden'></th><th name='optionHeader'>Icon</th></tr>";
+      for (var loop = 0; loop <= 9; loop++) {
+        content +=
+          "<tr>" +
+            "<td>"+translateKey("statusDisplayLine")+ " "+(loop + 1)+": </td>"+
+            "<td><select id='textSelect_"+loop+"' onchange='textOnChange(this)' >"+textOptions+"</select></td>" +
+            "<td id='cellFreeText_"+loop+"' class='hidden'><input id='freeText_"+loop+"' type='text' value='"+freeTextValue+"' maxlength='16' size='19' style='text-align:center'></td>" +
+            "<td id='placeHolder_"+loop+"' class='hidden'></td>" +
+            "<td name='optionContainer_"+loop+"' class='hidden'><select id='iconSelect_"+loop+"' onchange='iconOnChange(this)'>"+iconOptions+"</select></td>" +
+            "<td name='optionContainer_"+loop+"' class='hidden' id='iconPreview_"+loop+"'></td>"+
+          "</tr>";
+      }
+
+      content += "<tr><td colspan='4'><hr></td></tr>";
+
+      content += "<tr><td height='15px;'></td></tr>";
+
+      return content;
+    });
+  },
+
+    // Creates the options for the text selector
+  _getTextOptions: function() {
+    var options = "";
+    options += "<option value='-1'>"+translateKey("stringTableNotUsed")+"</option>";
+    for (var loop = 0; loop <= 9; loop++) {
+      options += "<option value='"+loop+"'>"+ translateKey("statusDisplayOptionText")+ " " +(loop + 1)+"</option>";
+    }
+    options += "<option value='99'>"+translateKey("statusDisplayOptionFreeText")+"</option>";
+    return options;
+  },
+
+    // Creates the options for the icon selector
+  _getIconOptions: function() {
+    var options = "",
+    arOptionText = [
+      translateKey("iconOff"),
+      translateKey("iconOn"),
+      translateKey("iconOpen"),
+      translateKey("iconClosed"),
+      translateKey("iconError"),
+      translateKey("iconOK"),
+      translateKey("iconInfo"),
+      translateKey("iconNewMessage"),
+      translateKey("iconServiceMessage")
+    ];
+
+    options += "<option name='option_NotUsed' value='-1'>" + translateKey("stringTableNotUsed") + "</option>";
+    for (var loop = 0; loop < 9; loop++) {
+      options += "<option name='option_"+loop+"' value='"+loop+"'>" + arOptionText[loop] + "</option>";
+    }
+    return options;
+  },
+
+   // Creates the string, necessary for the text field within the program
+  _createConfigString: function() {
+    var textElm, freeTextElm,iconElm,
+    result = this.startKey + ","; // Start key
+
+    // Read 10 lines and create string
+    for (var loop = 0; loop < 10; loop++) {
+      textElm = jQuery("#textSelect_" + loop);
+      iconElm = jQuery("#iconSelect_" + loop);
+      freeTextElm = jQuery("#freeText_" + loop);
+
+      if (textElm.val() == -1) {
+        result+= this.lf + ",";
+      } else {
+        result += this.textKey + ",";
+        if (textElm.val() != "99") {
+          // Predefined text bloc
+          result += this._convertVal2HexVal(textElm.val()) + ",";
+        } else {
+          // Free user customized text
+          //result += freeTextElm.val() + ",";
+          result += this._convertPlainText2Hex(freeTextElm.val());
+        }
+        if (iconElm.val() != -1) {
+          result += this.iconKey + ",";
+          result += this._convertVal2HexVal(iconElm.val()) + ",";
+        }
+        result += this.lf + ",";
+      }
+    }
+    result+= this.endKey; // End key
+    this.configString = result;
+  },
+  /**
+   * Initializes the dialog
+   * @private
+   */
+  _initAllValues: function() {
+    var self = this,
+    arValues = this.channelValue.split(","),
+    sizeChannelValue = arValues.length,
+    arAllValues = this._getAllValues();
+
+    conInfo("DIS-EP42BW: All values of the channel: ");
+    conInfo(arAllValues);
+
+    jQuery.each(arAllValues, function(index, line) {
+      var textElm = jQuery("#textSelect_" + index),
+      iconElm = jQuery("#iconSelect_" + index),
+      freeTextElm = jQuery("#freeText_" + index);
+
+      if (line.text != "notUsed") {
+        textElm.val(self._convertHexVal2Val(line.text));
+        // User defined text
+        if (parseInt(line.text.split(",")[0],16) < 128) {
+          freeTextElm.val(decodeStringStatusDisplay(self._convertHexString2PlainText(line.text)));
+        }
+        if (line.icon != -1) {
+          iconElm.val(self._convertHexVal2Val(line.icon));
+          setIconPreview({index: index, value: iconElm.val()});
+        } else {
+          // Icon not in use
+          iconElm.val("-1");
+        }
+        displayStatusDisplayOptionContainer(index, true);
+      } else {
+        textElm.val("-1");
+      }
+    });
+
+    setFreeTextContainer();
+  },
+    // Returns an array of objects with the values of all lines.
+  // [Object {text="0x80, color="0x81", icon="0x82},.....]}
+  _getAllValues: function() {
+    var val = this.channelValue;
+    var arValues = val.split(","), //replace(/ /g, "").split(","),
+    arLines = []; // contains the lines 1,2,3
+
+    // Is a start key and end key available? Otherwise the string isn¥t valid.
+    if (arValues[0] == this.startKey && arValues[arValues.length - 1] == this.endKey) {
+      var lineIndex = 0,
+      textIndex,
+      nextTextBlockIndex = 0,
+      textOffset = 0;
+
+      arValues.shift(); // remove the start key 0x02
+      arValues.pop(); // remove the end key 0x03
+      //console.log("arValues: " + arValues);
+      for (var loopx = 0; loopx < arValues.length; loopx++) {
+        //console.log("current loopx: " + loopx);
+        var valueSet = {};
+        nextTextBlockIndex = 0;
+                // Is LF?
+        if (arValues[loopx] == this.lf) {
+          valueSet.text="notUsed";
+           arLines[lineIndex] = valueSet;
+          lineIndex++;
+        }
+
+        if (arValues[loopx] == this.textKey) {
+          valueSet.text = "";
+          // Read till icon or lf and increase loopx by the number of read chars
+          textIndex = loopx + 1;
+          do {
+            valueSet.text += arValues[textIndex];
+            if ((arValues[textIndex + 1] != this.iconKey) && (arValues[textIndex + 1] != this.lf)) {
+              valueSet.text += ",";
+            }
+
+            //console.log("added char: " + arValues[textIndex]);
+            textIndex++;
+            nextTextBlockIndex++;
+          } while ((arValues[textIndex] != this.iconKey) && (arValues[textIndex] != this.lf)) ;
+
+          // Icon hinzuf¸gen, entweder nicht benutzt (-1) oder den entsprechenden Wert
+          // Add the icon, either not used (-1) or the correspondent value
+          valueSet.icon = (arValues[textIndex] == this.iconKey) ? arValues[textIndex + 1] : -1;
+          arLines[lineIndex] = valueSet;
+          lineIndex++;
+          if (valueSet.icon == -1) {textOffset = 1;} else {textOffset = 3;}
+          // Jump to the next text block
+          loopx += nextTextBlockIndex + textOffset; // Springe zum n‰chsten Textblock
+          //console.log("new loopx : " + loopx);
+        }
+      }
+    } else {
+      conInfo("Value string invalid");
+    }
+    return arLines;
+  }
+
+});
+
+YesNoDialog.RESULT_NO = 0;
+YesNoDialog.RESULT_YES = 1;
+
+
 /**
  * rgbwcontrollerdialog.js
  **/
--- ./patchsource/www/rega/pages/tabs/admin/views/programs.htm.orig	2018-12-01 18:41:48.000000000 +0100
+++ ./patchsource/www/rega/pages/tabs/admin/views/programs.htm	2018-11-29 22:54:25.000000000 +0100
@@ -141,7 +141,10 @@
   };
 
   SetStatusDisplay = function(regaDialogID, mode) {
-    var elm = (mode == "DIS") ? jQuery("#setStatusDisplay" + regaDialogID) : jQuery("#setStatusDisplayEPaper" + regaDialogID) ;
+   var elm;
+   if (mode == "DIS") elm = jQuery("#setStatusDisplay" + regaDialogID);
+   if (mode == "DIS-EP") elm = jQuery("#setStatusDisplayEPaper" + regaDialogID) ;
+   if (mode == "DIS-EP42BW") elm = jQuery("#setHbStatusDisplayEPaper" + regaDialogID) ;
 
     jQuery(elm).prop("disabled", true);
 
@@ -179,6 +182,19 @@
             inputElm.change();
           }
         }, "html");
+      } else if (mode == "DIS-EP42BW") {
+         statusDisplayDialog = new HbStatusDisplayDialogEPaper(translateKey("statusDisplayDialogTitle"), htmlContent, jQuery(inputElm).val(), function (result) {
+          jQuery(elm).prop("disabled", false);
+          if (result == 1) {
+            conInfo("SetStatusDisplay: Yes pressed");
+            var inputElm = jQuery(elm).prev();
+            var cfgString = this.getConfigString();
+            conInfo(cfgString);
+            inputElm.val(cfgString); //.change();
+            encodeStringStatusDisplay(inputElm.prop("id"));
+            inputElm.change();
+          }
+        }, "html");
       }
 
 
